const FEATURED_IDS=[4,11,18,26];let currentSlide=0,slideInterval=null,currentCategory="sustainability",categoryProjectIndex={};const CATEGORY_INFO={sustainability:{icon:"üåø",name:"Sustainability",description:"Comprehensive projects focused on ecological balance, sustainable mining practices, and environmental preservation. These initiatives demonstrate commitment to reducing environmental impact while maintaining economic viability."},food:{icon:"üç¥",name:"Food Security",description:"Strategic initiatives addressing food security challenges across Africa and developing regions. Projects include agricultural development, capacity building, and innovative solutions for sustainable food production systems."},realestate:{icon:"üè®",name:"Real Estate",description:"Diverse portfolio of real estate development and investment projects. From commercial properties to hospitality ventures, these projects combine strategic location analysis with sustainable development principles."},investment:{icon:"üí∞",name:"Investment",description:"Strategic investment opportunities and financial analyses across multiple sectors. Comprehensive feasibility studies and investment guides for informed decision-making in emerging markets."},technology:{icon:"‚ö°",name:"Technology",description:"Innovative technology solutions including renewable energy systems, smart infrastructure, and cutting-edge developments. Projects that leverage technology for sustainable development and improved quality of life."},research:{icon:"üìö",name:"Research",description:"In-depth research and academic publications covering sustainable development, economic analysis, and social impact studies. Evidence-based insights for policy and decision-making."}};document.addEventListener("DOMContentLoaded",function(){initSlideshow(),initCategoryTabs(),initModal(),initNavbar(),initMobileScrollLock()});let savedScrollY=0;function initMobileScrollLock(){const e=document.getElementById("mobile-modal-overlay"),t=document.getElementById("mobile-modal-close-btn"),n=document.getElementById("mobile-modal-view-btn");t&&t.addEventListener("click",closeMobileModal),e&&e.addEventListener("click",function(t){t.target===e&&closeMobileModal()}),n&&n.addEventListener("click",function(){const e=document.getElementById("mobile-modal-download-btn").href;window.open(e,"_blank")}),document.addEventListener("keydown",function(e){"Escape"===e.key&&closeMobileModal()})}function openMobileModal(e,t,n){const o=document.getElementById("mobile-modal-overlay");if(!o)return;const i=DOCUMENTS_BASE_PATH+t;document.getElementById("mobile-modal-name").textContent=e,document.getElementById("mobile-modal-desc").textContent=n||"",document.getElementById("mobile-modal-download-btn").href=i;if("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname)document.getElementById("mobile-modal-preview").src=i;else{const e=new URL(i,window.location.href).href;document.getElementById("mobile-modal-preview").src=`https://docs.google.com/viewer?url=${encodeURIComponent(e)}&embedded=true`}o.classList.add("active")}function closeMobileModal(){const e=document.getElementById("mobile-modal-overlay");e&&(e.classList.remove("active"),document.getElementById("mobile-modal-preview").src="")}function initSlideshow(){if("undefined"==typeof DOCUMENTS_DATA)return;const e=document.getElementById("slideshow");if(!e)return;const t=FEATURED_IDS.map(e=>DOCUMENTS_DATA.find(t=>t.id===e)).filter(Boolean),n=t.map((e,t)=>`\n        <div class="slide ${0===t?"active":""}" data-index="${t}" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.5)), url('${e.thumbnail||"assets/placeholder.jpg"}'); background-size: cover; background-position: center;">\n            <div class="slide-featured-header">\n               <span>‚≠ê FEATURED INSIGHTS</span>\n            </div>\n            <div class="slide-content">\n                <div class="slide-category">\n                   <span class="category-icon">${"investment"===e.category?"üí∞":"‚ö°"}</span>\n                   ${e.categoryLabel.replace("üåø ","").replace("üí∞ ","").replace("‚ö° ","")}\n                </div>\n                <h2 class="slide-title">${e.title}</h2>\n                <p class="slide-description">${e.description}</p>\n                <div class="slide-actions">\n                    <button class="slide-btn slide-btn-primary" onclick="openModal('${escapeQuotes(e.title)}', '${escapeQuotes(e.filename)}')">\n                        üëÅÔ∏è View Document\n                    </button>\n                    <a href="${DOCUMENTS_BASE_PATH}${e.filename}" class="slide-btn slide-btn-secondary" download>\n                        ‚¨áÔ∏è Download\n                    </a>\n                </div>\n            </div>\n        </div>\n    `).join(""),o=`\n        <div class="slideshow-controls">\n            <button class="slide-arrow" onclick="changeSlide(-1)">‚óÄ</button>\n            <div class="slide-dots">\n                ${t.map((e,t)=>`\n                    <span class="slide-dot ${0===t?"active":""}" data-index="${t}" onclick="goToSlide(${t})"></span>\n                `).join("")}\n            </div>\n            <button class="slide-arrow" onclick="changeSlide(1)">‚ñ∂</button>\n        </div>\n    `;e.innerHTML=n+o,startSlideshow()}function startSlideshow(){stopSlideshow(),document.hidden||(slideInterval=setInterval(()=>changeSlide(1),5e3))}function stopSlideshow(){slideInterval&&clearInterval(slideInterval)}function changeSlide(e){const t=document.querySelectorAll(".slide"),n=document.querySelectorAll(".slide-dot");t.length&&(t[currentSlide].classList.remove("active"),n[currentSlide].classList.remove("active"),currentSlide=(currentSlide+e+t.length)%t.length,t[currentSlide].classList.add("active"),n[currentSlide].classList.add("active"),startSlideshow())}function goToSlide(e){const t=document.querySelectorAll(".slide"),n=document.querySelectorAll(".slide-dot");t.length&&(t[currentSlide].classList.remove("active"),n[currentSlide].classList.remove("active"),currentSlide=e,t[currentSlide].classList.add("active"),n[currentSlide].classList.add("active"),startSlideshow())}function initNavbar(){console.log("Projects navigation initialized")}function initCategoryTabs(){if("undefined"==typeof DOCUMENTS_DATA)return;const e=document.getElementById("categoryTabs"),t=document.getElementById("categoryContents");if(!e||!t)return;const n={};DOCUMENTS_DATA.forEach(e=>{n[e.category]||(n[e.category]=[]),n[e.category].push(e)});const o=["sustainability","food","realestate","investment","technology","research"];o.forEach(e=>categoryProjectIndex[e]=0),e.innerHTML=o.map(e=>{const t=CATEGORY_INFO[e];return 0===(n[e]||[]).length?"":`\n            <button class="category-tab ${"sustainability"===e?"active":""}" \n                    data-category="${e}" \n                    onclick="selectCategory('${e}')">\n                <span class="category-tab-icon">${t.icon}</span>\n                <span>${t.name}</span>\n            </button>\n        `}).join(""),t.innerHTML=o.map(e=>{const t=CATEGORY_INFO[e],o=n[e]||[];return 0===o.length?"":`\n            <div class="category-content ${"sustainability"===e?"active":""}" data-category="${e}">\n                \x3c!-- Category Description --\x3e\n                <div class="category-description">\n                    <div class="category-desc-header">\n                        <span class="category-desc-icon">${t.icon}</span>\n                        <h3 class="category-desc-title">${t.name}</h3>\n                    </div>\n                    <p class="category-desc-text">${t.description}</p>\n                    <span class="category-project-count">${o.length} Projects</span>\n                </div>\n                \n                \x3c!-- Projects Grid - All visible --\x3e\n                <div class="projects-grid">\n                    ${o.map(e=>`\n                        <div class="project-card" onclick="toggleProjectCard(this, event)" \n                             data-title="${escapeQuotes(e.title)}" \n                             data-filename="${escapeQuotes(e.filename)}"\n                             data-description="${escapeQuotes(e.description||"")}"\n                             style="${e.thumbnail?`--project-bg: url('../${e.thumbnail}')`:""}">\n                            <div class="project-overlay"></div>\n                            \n                            \x3c!-- Floating Title Tab (Mobile Only) --\x3e\n                            <div class="project-title-tab">${e.title}</div>\n\n                            <div class="project-preview">\n                                ${e.thumbnail?`<img src="${e.thumbnail}" class="project-thumb-img" alt="${e.title}">`:`<span class="project-preview-icon">${getDocIcon(e.type)}</span>`}\n                                <span class="project-type-badge">${e.type}</span>\n                            </div>\n\n                            <div class="project-header-mobile-trigger">\n                                <span class="mobile-open-icon">+</span>\n                            </div>\n\n                            <div class="project-content">\n                                <div class="project-header-mobile">\n                                    <span class="mobile-chevron">‚úï</span>\n                                </div>\n                                <div class="project-modal-title">${e.title}</div>\n\n                                <div id="viewer-target-${e.id}" class="project-viewer-target"></div>\n\n                                <div class="project-meta">\n                                    <div class="meta-label">Type</div>\n                                    <div class="meta-value">${e.type}</div>\n                                    <div class="meta-label">File</div>\n                                    <div class="meta-value meta-filename">${e.filename}</div>\n                                </div>\n                                \n                                <h4 class="project-title desktop-only">${e.title}</h4>\n                                \n                                <div class="project-details-wrapper">\n                                    <p class="project-description">${e.description}</p>\n                                    <div class="project-actions">\n                                        <button class="project-btn project-btn-view" onclick="event.stopPropagation(); handleViewPdf('${escapeQuotes(e.filename)}', '${escapeQuotes(e.title)}')">\n                                            üëÅÔ∏è View PDF\n                                        </button>\n                                        <a href="${DOCUMENTS_BASE_PATH}${e.filename}" class="project-btn project-btn-download" download onclick="event.stopPropagation()">\n                                            ‚¨áÔ∏è Download\n                                        </a>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    `).join("")}\n                </div>\n            </div>\n        `}).join("")}function selectCategory(e){document.querySelectorAll(".category-tab").forEach(t=>{t.classList.toggle("active",t.dataset.category===e)}),document.querySelectorAll(".category-content").forEach(t=>{t.classList.toggle("active",t.dataset.category===e)}),currentCategory=e}function changeProjectSlide(e,t){const n=document.getElementById(`viewer-${e}`);if(!n)return;const o=n.querySelectorAll(".project-slide"),i=categoryProjectIndex[e];o[i].classList.remove("active");let a=i+t;a<0&&(a=o.length-1),a>=o.length&&(a=0),o[a].classList.add("active"),categoryProjectIndex[e]=a,document.getElementById(`counter-${e}`).textContent=a+1}function getDocIcon(e){return{PDF:"üìÑ",PPTX:"üìä",DOCX:"üìù"}[e]||"üìÑ"}function escapeQuotes(e){return e?e.toString().replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}function initModal(){const e=document.getElementById("pdfModal"),t=document.getElementById("modalClose");e&&t&&(t.addEventListener("click",closeModal),e.addEventListener("click",t=>{t.target===e&&closeModal()}),document.addEventListener("keydown",e=>{"Escape"===e.key&&closeModal()}))}function openModal(e,t){if(window.innerWidth<992){let n="";if("undefined"!=typeof DOCUMENTS_DATA){const e=DOCUMENTS_DATA.find(e=>e.filename===t);e&&(n=e.description)}return void openMobileModal(e,t,n)}const n=document.getElementById("pdfModal"),o=DOCUMENTS_BASE_PATH+t;document.getElementById("modalTitle").textContent=e;if("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname)document.getElementById("pdfViewer").src=o;else{const e=new URL(o,window.location.href).href,t=`https://docs.google.com/viewer?url=${encodeURIComponent(e)}&embedded=true`;document.getElementById("pdfViewer").src=t}document.getElementById("modalDownloadBtn").href=o,n.classList.add("project-modal-active"),n.style.display="flex",clearInterval(slideInterval)}function closeModal(){const e=document.getElementById("pdfModal");e&&(e.style.display="none",e.classList.remove("project-modal-active")),document.getElementById("pdfViewer").src="",startSlideshow()}function handleViewPdf(e,t){const n=window.innerWidth<992,o=DOCUMENTS_BASE_PATH+e;n?window.open(o,"_blank"):openModal(t,e)}function toggleProjectCard(e,t){if(!t.target.closest(".project-btn")&&"A"!==t.target.tagName){if(window.innerWidth>=992){const t=e.getAttribute("data-title"),n=e.getAttribute("data-filename");return void(t&&n&&openModal(t,n))}document.querySelectorAll(".project-card.expanded").forEach(t=>{t!==e&&t.classList.remove("expanded")}),e.classList.toggle("expanded")}}window.onpopstate=null,window.history.state&&window.history.state.isModalOpen&&window.history.replaceState(null,""),document.addEventListener("visibilitychange",()=>{document.hidden?stopSlideshow():startSlideshow()});