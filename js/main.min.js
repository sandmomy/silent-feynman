function initSmoothScroll(){if(window.lenis)console.log("Lenis already initialized, skipping");else if("undefined"!=typeof Lenis)try{const e=new Lenis({duration:1.2,easing:e=>Math.min(1,1.001-Math.pow(2,-10*e)),direction:"vertical",gestureDirection:"vertical",smooth:!0,mouseMultiplier:1,smoothTouch:!1,touchMultiplier:2,infinite:!1});e.on("scroll",()=>{}),requestAnimationFrame(function t(n){e.raf(n),requestAnimationFrame(t)}),window.lenisInstance=e,window.lenis=e,console.log("Lenis smooth scroll initialized")}catch(e){console.error("Error initializing Lenis:",e)}else console.log("Lenis not loaded, skipping smooth scroll")}function initHeroGlobe(){console.log("Initializing Hero Globe (HTML/SVG Markers)...");const e=document.getElementById("hero-globe");if(!e)return;const t=["Indonesia","Nigeria","Kenya"],n=[{lat:-6.2,lng:106.8,name:"Jakarta",color:"#ef4444"},{lat:-8.4,lng:115.2,name:"Bali",color:"#ef4444"},{lat:9,lng:8,name:"Nigeria",color:"#ef4444"},{lat:-1.3,lng:36.8,name:"Kenya",color:"#ef4444"}],a=e.getBoundingClientRect(),o=window.innerWidth<=992?165:Math.max(Math.min(a.width,a.height||400),150),s=Globe().width(o).height(o).backgroundColor("rgba(0,0,0,0)").globeImageUrl("assets/optimized/earth-day.480w.webp").showAtmosphere(!0).atmosphereColor("#48bb78").atmosphereAltitude(.12);let i=[];i="undefined"!=typeof DOCUMENTS_DATA?DOCUMENTS_DATA.filter(e=>void 0!==e.lat&&void 0!==e.lng):n,s.htmlElementsData(i).htmlLat("lat").htmlLng("lng").htmlAltitude(.05).htmlElement(e=>{const t=document.createElement("div");t.className="globe-pin-container",t.style.position="relative",t.style.transform="translate(-50%, -100%)",t.style.cursor="pointer",t.style.pointerEvents="auto";const n=document.createElement("div");n.className="map-pin small-ping",n.style.background="transparent",n.innerHTML='\n                <svg viewBox="0 0 24 24" width="16" height="16" fill="#ef4444" stroke="white" stroke-width="1.5" style="filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3)); display: block;">\n                    <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>\n                    <circle cx="12" cy="9" r="2.5" fill="white"/>\n                </svg>\n            ',t.appendChild(n);const a=document.createElement("div");a.className="globe-tooltip",a.innerHTML=`\n                <div class="tooltip-category">${e.categoryLabel||"Project"}</div>\n                <div class="tooltip-title">${e.title}</div>\n            `,Object.assign(a.style,{position:"absolute",bottom:"120%",left:"50%",transform:"translateX(-50%)",background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(8px)",padding:"8px 12px",borderRadius:"8px",boxShadow:"0 4px 15px rgba(0,0,0,0.15)",whiteSpace:"nowrap",pointerEvents:"none",opacity:"0",transition:"opacity 0.2s, transform 0.2s",marginTop:"10px",zIndex:"100",border:"1px solid rgba(0,0,0,0.05)",textAlign:"center",minWidth:"150px"});return a.querySelector(".tooltip-title").style.cssText="font-size: 12px; font-weight: 700; color: #1a202c; display: block; margin-top: 2px;",a.querySelector(".tooltip-category").style.cssText="font-size: 10px; font-weight: 600; color: #38a169; text-transform: uppercase; letter-spacing: 0.5px;",t.appendChild(a),t.addEventListener("mouseenter",()=>{a.style.opacity="1",a.style.transform="translateX(-50%) translateY(-5px)",n.style.transform="scale(1.2) translateY(-2px)",s.controls().autoRotate=!1}),t.addEventListener("mouseleave",()=>{a.style.opacity="0",a.style.transform="translateX(-50%) translateY(0)",n.style.transform="scale(1) translateY(0)",s.controls().autoRotate=!0}),t.addEventListener("click",t=>{t.stopPropagation(),"function"==typeof openModal?openModal(e.title,e.filename):alert(`${e.title}\n\n${e.description}`)}),t}),s(e);const r=()=>{const t=e.getBoundingClientRect();if(window.innerWidth<=992){const e=Math.max(150,Math.min(170,Math.round(t.width)||0));return s.width(e),void s.height(e)}const n=Math.max(320,Math.round(t.width)),a=Math.max(320,Math.round(t.height));s.width(n),s.height(a)};r(),s.pointOfView({lat:0,lng:10,altitude:2.5},0);const l=s.controls();l.autoRotate=!0,l.autoRotateSpeed=-1.5,l.enableZoom=!1,l.enableDamping=!0,l.dampingFactor=.05;const c=s.renderer();c&&c.setPixelRatio(1);let d=null,u=!1;function p(){if(!d&&c){!function e(){d=requestAnimationFrame(e),l.update(),c.render(s.scene(),s.camera())}()}}function m(){u&&(u=!1,l.autoRotate=!1,e.style.opacity="0",setTimeout(()=>{u||d&&(cancelAnimationFrame(d),d=null)},600))}e.style.opacity="1",e.style.transform="scale(1)",e.style.transition="opacity 0.6s ease, transform 0.6s ease";let h,g;new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting?u||(u=!0,p(),requestAnimationFrame(()=>{e.style.opacity="1"}),l.autoRotate=!0):m()})},{threshold:.2}).observe(e),u=!0,p(),window.addEventListener("resize",()=>{clearTimeout(h),h=setTimeout(()=>{r()},150)}),setTimeout(r,50),setTimeout(r,300),setTimeout(r,1e3),l.addEventListener("start",()=>{clearTimeout(g),l.autoRotate=!1}),l.addEventListener("end",()=>{g=setTimeout(()=>{l.autoRotate=!0},3e3)}),fetch("assets/countries.geojson").then(e=>e.json()).then(e=>{const n=e.features.filter(e=>{const n=e.properties.ADMIN||e.properties.name;return t.includes(n)});s.polygonsData(n).polygonCapColor(()=>"#4299e1").polygonSideColor(()=>"rgba(66, 153, 225, 0.5)").polygonStrokeColor(()=>"#2c5282").polygonAltitude(.015)}).catch(e=>console.error("Error loading countries:",e))}function initNavigation(){console.log("Mobile navigation removed per user request")}function initScrollEffects(){const e=new IntersectionObserver(e=>{e.forEach(e=>e.isIntersecting&&e.target.classList.add("visible"))},{threshold:.1});document.querySelectorAll(".section-title, .stat-card, .project-card").forEach(t=>{t.classList.add("fade-in"),e.observe(t)})}function initStatsAnimation(){const e=document.querySelector(".hero-stats-row");if(!e)return;const t=new IntersectionObserver(e=>{e[0].isIntersecting&&(document.querySelectorAll(".stat-num").forEach(e=>{const t=e.innerText,n=parseInt(t.replace(/\D/g,""));if(isNaN(n))return;let a=0,o=Math.ceil(n/50);const s=setInterval(()=>{a+=o,a>=n?(e.textContent=t,clearInterval(s)):e.textContent=a},40)}),t.disconnect())},{threshold:.5});t.observe(e)}function initEventCarousel(){const e=document.getElementById("eventCarousel");if(!e)return;const t=e.querySelectorAll(".carousel-slide"),n=e.querySelectorAll(".dot");let a,o=0;function s(e){e>=t.length&&(e=0),e<0&&(e=t.length-1),o=e,t.forEach((t,n)=>{t.classList.toggle("active",n===e)}),n.forEach((t,n)=>{t.classList.toggle("active",n===e)})}function i(){s(o+1)}function r(){l(),a=setInterval(i,4e3)}function l(){a&&clearInterval(a)}n.forEach(e=>{e.addEventListener("click",()=>{l(),s(parseInt(e.dataset.slide)),r()})}),e.addEventListener("mouseenter",l),e.addEventListener("mouseleave",r),e.addEventListener("touchstart",l,{passive:!0}),e.addEventListener("touchend",r,{passive:!0}),r()}function initCountrySlider(){const e=document.querySelector(".country-slider");if(!e)return;const t=e.querySelectorAll(".country-slide");if(0===t.length)return;const n={Indonesia:["assets/optimized/karangasem-water-temple-palace-bali.800w.webp","assets/optimized/bali-pagoda-indonesia.800w.webp","assets/optimized/pexels-maxravier-2253818.800w.webp"],Nigeria:["assets/optimized/ahmad-jaafar-toQTkWFvWyo-unsplash.800w.webp","assets/optimized/muhammed-a-mustapha-aaIsU06zWrg-unsplash.800w.webp","assets/optimized/ovinuchi-ejiohuo-q4U9Pyfz-vQ-unsplash.800w.webp"],Kenya:["assets/optimized/ahmed-qinawy-9Ia_6613pYk-unsplash.800w.webp","assets/optimized/murad-swaleh-7tDidSXbgD8-unsplash.800w.webp","assets/optimized/ab-saf-sgFNwIc51lM-unsplash.800w.webp"]};Object.values(n).flat().forEach(e=>{(new Image).src=e});let a,o=0,s=0;function i(e){t.forEach((t,n)=>{t.classList.toggle("active",n===e)}),function(e,t){const a=e.querySelector("img");if(!a)return;const o=function(e){const t=e.querySelector(".country-label-sub");return(t?t.textContent:"").trim()}(e),s=n[o];if(!s||0===s.length)return;const i=s[t%s.length];a.src=i,a.alt=`${o} - Events`}(t[e],s)}function r(){o=(o+1)%t.length,0===o&&(s=(s+1)%3),i(o)}i(o);const l=()=>{a=setInterval(r,3e3)};document.addEventListener("visibilitychange",()=>{document.hidden?clearInterval(a):l()}),l()}function initFadeAnimations(){const e=document.querySelectorAll(".fade-section, .fade-scale, .fade-left, .fade-right");if(0===e.length)return;const t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&e.target.classList.add("visible")})},{root:null,rootMargin:"0px 0px -100px 0px",threshold:.1});e.forEach(e=>t.observe(e))}function initEventCarousel(){const e=document.getElementById("eventCarousel");if(!e)return;const t=e.querySelectorAll(".carousel-slide"),n=e.querySelectorAll(".dot");let a,o=0;function s(e){e>=t.length&&(e=0),e<0&&(e=t.length-1),o=e,t.forEach((t,n)=>{t.classList.toggle("active",n===e)}),n.forEach((t,n)=>{t.classList.toggle("active",n===e)})}function i(){s(o+1)}function r(){l(),a=setInterval(i,4e3)}function l(){a&&clearInterval(a)}n.forEach(e=>{e.addEventListener("click",()=>{l(),s(parseInt(e.dataset.slide)),r()})}),e.addEventListener("mouseenter",l),e.addEventListener("mouseleave",r),e.addEventListener("touchstart",l,{passive:!0}),e.addEventListener("touchend",r,{passive:!0}),r()}function initCountrySlider(){const e=document.querySelector(".country-slider");if(!e)return;const t=e.querySelectorAll(".country-slide");if(0===t.length)return;const n={Indonesia:["assets/optimized/karangasem-water-temple-palace-bali.800w.webp","assets/optimized/bali-pagoda-indonesia.800w.webp","assets/optimized/pexels-maxravier-2253818.800w.webp"],Nigeria:["assets/optimized/ahmad-jaafar-toQTkWFvWyo-unsplash.800w.webp","assets/optimized/muhammed-a-mustapha-aaIsU06zWrg-unsplash.800w.webp","assets/optimized/ovinuchi-ejiohuo-q4U9Pyfz-vQ-unsplash.800w.webp"],Kenya:["assets/optimized/ahmed-qinawy-9Ia_6613pYk-unsplash.800w.webp","assets/optimized/murad-swaleh-7tDidSXbgD8-unsplash.800w.webp","assets/optimized/ab-saf-sgFNwIc51lM-unsplash.800w.webp"]};Object.values(n).flat().forEach(e=>{(new Image).src=e});let a,o=0,s=0;function i(e){t.forEach((t,n)=>{t.classList.toggle("active",n===e)}),function(e,t){const a=e.querySelector("img");if(!a)return;const o=function(e){const t=e.querySelector(".country-label-sub");return(t?t.textContent:"").trim()}(e),s=n[o];if(!s||0===s.length)return;const i=s[t%s.length];a.src=i,a.alt=`${o} - Events`}(t[e],s)}function r(){o=(o+1)%t.length,0===o&&(s=(s+1)%3),i(o)}i(o);const l=()=>{a=setInterval(r,3e3)};document.addEventListener("visibilitychange",()=>{document.hidden?clearInterval(a):l()}),l()}function initEventCarousel(){const e=document.getElementById("eventCarousel");if(!e)return;const t=e.querySelectorAll(".carousel-slide"),n=e.querySelectorAll(".dot");let a,o=0;function s(e){e>=t.length&&(e=0),e<0&&(e=t.length-1),o=e,t.forEach((t,n)=>{t.classList.toggle("active",n===e)}),n.forEach((t,n)=>{t.classList.toggle("active",n===e)})}function i(){s(o+1)}function r(){l(),a=setInterval(i,4e3)}function l(){a&&clearInterval(a)}n.forEach(e=>{e.addEventListener("click",()=>{l(),s(parseInt(e.dataset.slide)),r()})}),e.addEventListener("mouseenter",l),e.addEventListener("mouseleave",r),e.addEventListener("touchstart",l,{passive:!0}),e.addEventListener("touchend",r,{passive:!0}),r()}function initCountrySlider(){const e=document.querySelector(".country-slider");if(!e)return;const t=e.querySelectorAll(".country-slide");if(0===t.length)return;const n={Indonesia:["assets/optimized/karangasem-water-temple-palace-bali.800w.webp","assets/optimized/bali-pagoda-indonesia.800w.webp","assets/optimized/pexels-maxravier-2253818.800w.webp"],Nigeria:["assets/optimized/ahmad-jaafar-toQTkWFvWyo-unsplash.800w.webp","assets/optimized/muhammed-a-mustapha-aaIsU06zWrg-unsplash.800w.webp","assets/optimized/ovinuchi-ejiohuo-q4U9Pyfz-vQ-unsplash.800w.webp"],Kenya:["assets/optimized/ahmed-qinawy-9Ia_6613pYk-unsplash.800w.webp","assets/optimized/murad-swaleh-7tDidSXbgD8-unsplash.800w.webp","assets/optimized/ab-saf-sgFNwIc51lM-unsplash.800w.webp"]};Object.values(n).flat().forEach(e=>{(new Image).src=e});let a,o=0,s=0;function i(e){t.forEach((t,n)=>{t.classList.toggle("active",n===e)}),function(e,t){const a=e.querySelector("img");if(!a)return;const o=function(e){const t=e.querySelector(".country-label-sub");return(t?t.textContent:"").trim()}(e),s=n[o];if(!s||0===s.length)return;const i=s[t%s.length];a.src=i,a.alt=`${o} - Events`}(t[e],s)}function r(){o=(o+1)%t.length,0===o&&(s=(s+1)%3),i(o)}i(o);const l=()=>{a=setInterval(r,3e3)};document.addEventListener("visibilitychange",()=>{document.hidden?clearInterval(a):l()}),l()}function initFadeAnimations(){const e=document.querySelectorAll(".fade-section, .fade-scale, .fade-left, .fade-right");if(0===e.length)return;const t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&e.target.classList.add("visible")})},{root:null,rootMargin:"0px 0px -100px 0px",threshold:.1});e.forEach(e=>t.observe(e))}document.addEventListener("DOMContentLoaded",function(){initSmoothScroll(),initNavigation(),initScrollEffects(),initStatsAnimation(),initHeroGlobe(),initCountrySlider()}),document.addEventListener("DOMContentLoaded",initEventCarousel),document.addEventListener("DOMContentLoaded",initFadeAnimations),document.addEventListener("DOMContentLoaded",()=>{initEventCarousel(),initCountrySlider()}),document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("partnersBtn"),t=document.getElementById("partnersDropdown");e&&t&&(e.addEventListener("click",n=>{n.stopPropagation();const a="true"===e.getAttribute("aria-expanded");e.setAttribute("aria-expanded",!a),t.classList.toggle("active")}),document.addEventListener("click",n=>{t.contains(n.target)||e.contains(n.target)||(e.setAttribute("aria-expanded","false"),t.classList.remove("active"))}),document.addEventListener("keydown",n=>{"Escape"===n.key&&t.classList.contains("active")&&(e.setAttribute("aria-expanded","false"),t.classList.remove("active"),e.focus())}))}),document.addEventListener("DOMContentLoaded",initEventCarousel),document.addEventListener("DOMContentLoaded",initFadeAnimations),document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("partnersBtn"),t=document.getElementById("partnersDropdown");e&&t&&(e.addEventListener("click",n=>{n.stopPropagation();const a="true"===e.getAttribute("aria-expanded");e.setAttribute("aria-expanded",!a),t.classList.toggle("active")}),document.addEventListener("click",n=>{t.contains(n.target)||e.contains(n.target)||(e.setAttribute("aria-expanded","false"),t.classList.remove("active"))}),document.addEventListener("keydown",n=>{"Escape"===n.key&&t.classList.contains("active")&&(e.setAttribute("aria-expanded","false"),t.classList.remove("active"),e.focus())}))});